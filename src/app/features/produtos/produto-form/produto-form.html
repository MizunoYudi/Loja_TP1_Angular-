<section class="form-container">
    <h2>Novo produto</h2>
    <form #formulario="ngForm" (ngSubmit)="onSubmit(formulario)">
        <div class="campo">
            <label for="nome">Nome:</label>
            <input type="text" name="nome" id="nome" [(ngModel)]="novoProduto.nome" required minlength="3">
            <small class="erro" [hidden]="!(formulario.controls['nome'].dirty && formulario.controls['nome'].invalid)">
                O nome deve conter pelo menos 3 letras
            </small>
            <!-- Validado apenas na submissão 
            <small class="erro" [hidden]="!(formulario.submitted && formulario.controls['nome'].invalid)"></small> 
            -->
        </div>
        <div class="campo">
            <label for="preco">preco:</label>
            <input type="number" name="preco" id="preco" [(ngModel)]="novoProduto.preco" required min="0">
            @if(formulario.controls['preco'].dirty && formulario.controls['preco'].invalid){
            <small class="erro">Informe preço valido</small>
            }
            <!-- Validado apenas na submissão 
            <small class="erro" [hidden]="!(formulario.submitted && formulario.controls['preco'].invalid)"></small> 
            -->
        </div>
        <div class="campo">
            <label for="descricao">descricao:</label>
            <input type="textarea" name="descricao" id="descricao" [(ngModel)]="novoProduto.descricao" required>
            @if(formulario.controls['descricao'].dirty && formulario.controls['descricao'].invalid){
            <small class="erro">Informe uma descrição</small>
            }
            <!-- Validado apenas na submissão 
            <small class="erro" [hidden]="!(formulario.submitted && formulario.controls['descricao'].invalid)"></small> 
            -->
        </div>
        <div class="campo">
            <label for="categoria">Categoria</label>
            <select name="categoria" id="categoria" [(ngModel)]="categoriaSelecionada" required>
                <option value="">Selecione</option>
                @for(categoria of categorias(); track categoria){
                <option [value]="categoria">{{ categoria }}</option>
                }
            </select>
            @if(formulario.controls['categoria'].dirty && formulario.controls['categoria'].invalid){
            <small class="erro">Selecione uma cartegoria</small>
            }
        </div>

        @if(mostrarNovaCategoria()){
        <div class="campo">
            <label for="novaCategoria">Nova Categoria</label>
            <input type="text" name="novaCategoria" id="novaCategoria" [(ngModel)]="novaCategoria" required
                placeholder="Digite a nova categoria">
            @if(
            mostrarNovaCategoria() &&
            formulario.controls['novaCategoria'].dirty &&
            novaCategoria().trim.length == 0
            ){
            <small class="error">Digite a nova categoria</small>
            }
        </div>
        }

        <div class="campo">
            <label for="imgURL">URL da imagem</label>
            <input type="text" name="imageURL" id="imageURL" [(ngModel)]="novoProduto.imageUrl" required>
            @if(formulario.controls['imageURL'].dirty && formulario.controls['imageURL'].invalid){
            <small>Informe a url da imagem</small>
            }
        </div>
        <div class="campo check">
            <label for="promo">
                <input type="checkbox" name="promo" id="promo" [(ngModel)]="novoProduto.promo">
                Em promoção
            </label>
        </div>
        <div class="botoesform">
            <button type="submit" [disabled]="enviando()">Salvar Produto</button>
            <button type="button" class="botaocancelar" (click)="onReturnToList()">Cancelar</button>
        </div>
        @if(mensagem()){
            <p class="mensagem">{{ mensagem() }}</p>
        }
    </form>
</section>